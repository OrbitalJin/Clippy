{"_default": {"1": {"id": "b9825916-1598-457a-9c7f-51279655fd97", "type": "text", "content": "from PySide2.QtGui import *\nfrom PySide2.QtCore import *\nfrom PySide2.QtWidgets import *\n\nfrom ui.interface import Ui_MainWindow\nfrom components.scrollbar import CScrollBar\nfrom components.clipWidget import ClipWidget\n\nfrom utils.hotkeyWorker import HotKeyWorker\nfrom utils.clipWorker import ClipListener\nfrom utils.itemManager import ItemManager\n\nfrom tinydb import TinyDB, Query\nfrom datetime import datetime\nimport pyperclip as cliplib\nfrom pprint import pprint\nfrom uuid import uuid4\nimport sys, os\n\nif sys.platform in \"linux darwin\": host = \"*unix\"; import notify2\nelse: host = \"win32\"; from win10toast_click import ToastNotifier\nif host == \"win32\": winNotify = ToastNotifier()\nelse: notify2.init(\"ClipPy - Notifier\")\n\nPATH_TO_DB   = \"./data/db.json\"\nPATH_TO_ICON = \"../res/icons/icon_clipboard.svg\"\n\nclass App(QMainWindow):\n\tdef __init__(self):\n\t\tQMainWindow.__init__(self)\n\t\tself.ui = Ui_MainWindow()\n\t\tself.ui.setupUi(self)\n\t\tself.setupSystemTray()\n\t\tself.adjustUi()\n\n\t\tself.ClipListener = ClipListener()\n\t\tself.ClipListener.start()\n\n\t\tself.HotKeys = ['Ctrl+ALT+H', 'Ctrl+ALT+Z', 'Ctrl+ALT+C']\n\t\tself.HotKeyListener = HotKeyWorker(self.HotKeys)\n\t\tself.HotKeyListener.start()\n\n\t\tself.ItemManager = ItemManager(\"./data/db.json\", self)\n\t\tself.ItemManager.populateList()\n\n\t\tself.connectSignalsAndSlots()\n\t\tself.setupShortcuts()\n\t\tself.center()\n\n# Setup:\n\tdef adjustUi(self):\n\t\tself.setWindowFlags(Qt.FramelessWindowHint | Qt.WindowStaysOnTopHint | Qt.Popup)\n\t\tself.setWindowTitle(\"ClipPy\")\n\t\tself.setWindowOpacity(.95)\n\t\tself.setFocus()\n\t\tself.ui.searchBar.setFocus()\n\t\tself.ui.searchBar.setContextMenuPolicy(Qt.NoContextMenu)\n\t\tself.ui.clipsListWidget.setVerticalScrollBar(CScrollBar())\n\n\tdef setupShortcuts(self):\n\t\tQShortcut(QKeySequence('Ctrl+Q'), self).activated.connect(self.closeApp)\n\n\tdef setupSystemTray(self):\n\t\tself.TrayIcon = QSystemTrayIcon(QIcon(PATH_TO_ICON))\n\t\tself.TrayIcon.setToolTip(\"ClipPy\")\n\t\tself.TrayMenu = QMenu(self)\n\t\texitAction = self.TrayMenu.addAction(\"Exit\")\n\t\texitAction.triggered.connect(self.closeApp)\n\t\tshowAction = self.TrayMenu.addAction(\"Show\")\n\t\tshowAction.triggered.connect(self.show)\n\t\tshowAction.triggered.connect(self.ui.searchBar.setFocus)\n\t\tsettingsAction = self.TrayMenu.addAction(\"Settings\")\n\t\tself.TrayIcon.setContextMenu(self.TrayMenu)\n\t\tself.TrayIcon.show()\n\n\tdef connectSignalsAndSlots(self):\n\t\tself.ClipListener.newClipSignalEvent.connect(lambda clip: self.newClipEventSlot(clip))\n\t\tself.ClipListener.unavailableClipEvent.connect(lambda status: print(f\"ClipListener: {status}\"))\n\t\tself.HotKeyListener.combinationDetected.connect(lambda cmd: self.hotkeySlot(cmd))\n\n\t\tself.ui.clipsListWidget.itemActivated.connect(self.itemClipActivatedCallback)\n\t\tself.ui.searchBar.textChanged.connect(lambda text: self.filterClipboard(text))\n\t\tself.ui.searchBar.returnPressed.connect(lambda: self.ui.clipsListWidget.setFocus())\n\t\tself.ui.searchBar.returnPressed.connect(lambda: self.ui.clipsListWidget.setCurrentRow(0))\n\n\t\tself.ui.settingsBtn.clicked.connect(lambda: self.HotKeyListener.doWork())\n\t\tself.ui.closeAppBtn.clicked.connect(self.closeApp)\n\n# Slots:\n\t@Slot()\n\tdef newClipEventSlot(self, clip: str):\n\t\tnow = datetime.now()\n\t\tclipData = {\n\t\t\t\"id\": str(uuid4()),\n\t\t\t\"type\": \"text\",\n\t\t\t\"content\": clip,\n\t\t\t\"date\": now.strftime(\"%d/%m/%Y, %H:%M:%S\"),\n\t\t}\n\t\tpprint(clipData)\n\t\tself.ItemManager.newItem(clipData)\n\n\t@Slot()\n\tdef hotkeySlot(self, cmd: str):\n\t\tdef c():\n\t\t\tif not self.isVisible():self.center()\n\t\t\tself.setVisible(not self.isVisible())\n\n\t\tif cmd == \"h\": self.ui.clipsListWidget.clear()\n\t\tif cmd == \"z\": self.itemClipActivatedCallback(self.ui.clipsListWidget.item(1)) if self.ui.clipsListWidget.count() > 1 else None\n\t\tif cmd == \"c\": c()\n\n# Callbacks:\n\tdef itemClipActivatedCallback(self, item: QListWidgetItem):\n\t\tdef  sling_method():\n\t\t\tself.ui.statusLabel.setText(\"ClipPy v.0.1\")\n\t\t\tself.ui.statusLabel.setStyleSheet(\"color: grey;\")\n\n\t\ttxt = self.ui.clipsListWidget.itemWidget(item).getClipContent()\n\t\tcliplib.copy(txt)\n\t\tself.pushClipToDataBase(item.text())\n\t\tself.notify(\"ClipPy - Notifier\", f\"{item.text()} copied to the clipboard!\", 1000)\n\n\t\tself.ui.statusLabel.setStyleSheet(\"color: #5E81AC;\")\n\t\tself.ui.statusLabel.setText(f\"Entry copied to the clipboard!\")\n\t\tQTimer.singleShot(3500, sling_method)\n\t\tQTimer.singleShot(400, self.hide)\n\n\tdef itemClipSelectedCallback(self, item: QListWidgetItem):\n\t\tself.ui.clipsListWidget.setItemSelected(item, True)\n\n# Methods:\n\tdef removeClipWidgetItem(self, item: QListWidgetItem):\n\t\tindex = self.ui.clipsListWidget.indexFromItem(item).row()\n\t\titem = self.ui.clipsListWidget.takeItem(index)\n\n\tdef pushClipToDataBase(self, clip: str):\n\t\tpass\n\n\tdef filterClipboard(self, text: str):\n\t\tfor index in range(self.ui.clipsListWidget.count()):\n\t\t\titem = self.ui.clipsListWidget.item(index)\n\t\t\twidget = self.ui.clipsListWidget.itemWidget(item)\n\t\t\tcontent = widget.getClipContent()\n\t\t\titem.setHidden(not text.lower() in content.lower())\n\n\tdef notify(self, title: str, msg: str, timeout: int):\n\t\tif host == \"*unix\":\n\t\t\tnotification = notify2.Notification(summary = title, message = msg)\n\t\t\tnotification.set_timeout(timeout)\n\t\t\tnotification.show()\n\t\telse: winNotify.show_toast(title, msg, duration = int(timeout/1000), threaded = True)\n\n# Internal Events:\n\tdef hideEvent(self, event: QEvent):\n\t\tself.TrayIcon.show()\n\t\tprint(\"Hidden\")\n\n\tdef showEvent(self, event: QEvent):\n\t\tself.TrayIcon.hide()\n\t\tprint(\"Shown\")\n\n# Private:\n\tdef setRoundEdges(self):\n\t\tself.radius = 8.0\n\t\tself.path = QPainterPath()\n\t\tself.path.addRoundedRect(QRectF(self.rect()), self.radius, self.radius)\n\t\tself.mask = QRegion(self.path.toFillPolygon().toPolygon())\n\t\tself.setMask(self.mask)\n\t\n\tdef center(self):\n\t\tself.x_shift = 0 #-10\n\t\tself.y_shift = 0 #-360\n\t\tself.frame = self.frameGeometry()\n\t\tscreen = QGuiApplication.screenAt(QApplication.desktop().cursor().pos())\n\t\tcenterPoint = screen.availableGeometry().center()\n\t\tself.frame.moveCenter(centerPoint)\n\t\tself.move(self.frame.topLeft().x()+self.x_shift, self.frame.topLeft().y()+self.y_shift)\n\n\tdef stopRunningThreads(self):\n\t\tself.ClipListener.stop()\n\t\tself.ClipListener.quit()\n\t\tself.ClipListener.wait()\n\t\tself.HotKeyListener.stop()\n\t\tself.HotKeyListener.quit()\n\t\tself.HotKeyListener.wait()\n\t\tprint(\"ClipListener Thread: \", self.ClipListener.isRunning())\n\t\tprint(\"HotKeyListener Thread: \", self.HotKeyListener.isRunning())\n\n\tdef closeApp(self):\n\t\tself.setWindowFlags(self.windowFlags() & ~Qt.Popup) # Removing the popup flag because it prevents the app from fulling closing\n\t\tself.stopRunningThreads()\n\t\tself.close()\n\t\tsys.exit(0)\t\t\t\t\t\t\t\t\t\t\t# To fully close the application flagged as a popup\n\n# Entry Point:\ndef fontCheck(app):\n    font = QFont(\"Segoe UI\")\n    font.setPointSize(11)\n    if host == \"win32\": app.setFont(font)\n    elif host in \"linux darwin\": pass\n    return app\n\nif __name__ == \"__main__\":\n    app = QApplication(sys.argv)\n    app = fontCheck(app)\n    window = App()\n    window.show()\n    sys.exit(app.exec_())\n", "date": "18/01/2023, 20:50:13"}, "2": {"id": "ad196118-ae0e-47dd-82d6-cd2cf26ee97f", "type": "text", "content": "from PySide2.QtGui import *\nfrom PySide2.QtCore import *\nfrom PySide2.QtWidgets import *\n\nfrom ui.interface import Ui_MainWindow\nfrom components.scrollbar import CScrollBar\nfrom components.clipWidget import ClipWidget\n\nfrom utils.hotkeyWorker import HotKeyWorker\nfrom utils.clipWorker import ClipListener\nfrom utils.itemManager import ItemManager\n\nfrom tinydb import TinyDB, Query\nfrom datetime import datetime\nimport pyperclip as cliplib\nfrom pprint import pprint\nfrom uuid import uuid4\nimport sys, os\n\nif sys.platform in \"linux darwin\": host = \"*unix\"; import notify2\nelse: host = \"win32\"; from win10toast_click import ToastNotifier\nif host == \"win32\": winNotify = ToastNotifier()\nelse: notify2.init(\"ClipPy - Notifier\")\n\nPATH_TO_DB   = \"./data/db.json\"\nPATH_TO_ICON = \"../res/icons/icon_clipboard.svg\"\n\nclass App(QMainWindow):\n\tdef __init__(self):\n\t\tQMainWindow.__init__(self)\n\t\tself.ui = Ui_MainWindow()\n\t\tself.ui.setupUi(self)\n\t\tself.setupSystemTray()\n\t\tself.adjustUi()\n\n\t\tself.ClipListener = ClipListener()\n\t\tself.ClipListener.start()\n\n\t\tself.HotKeys = ['Ctrl+ALT+H', 'Ctrl+ALT+Z', 'Ctrl+ALT+C']\n\t\tself.HotKeyListener = HotKeyWorker(self.HotKeys)\n\t\tself.HotKeyListener.start()\n\n\t\tself.ItemManager = ItemManager(\"./data/db.json\", self)\n\t\tself.ItemManager.populateList()\n\n\t\tself.connectSignalsAndSlots()\n\t\tself.setupShortcuts()\n\t\tself.center()\n\n# Setup:\n\tdef adjustUi(self):\n\t\tself.setWindowFlags(Qt.FramelessWindowHint | Qt.WindowStaysOnTopHint | Qt.Popup)\n\t\tself.setWindowTitle(\"ClipPy\")\n\t\tself.setWindowOpacity(.95)\n\t\tself.setFocus()\n\t\tself.ui.searchBar.setFocus()\n\t\tself.ui.searchBar.setContextMenuPolicy(Qt.NoContextMenu)\n\t\tself.ui.clipsListWidget.setVerticalScrollBar(CScrollBar())\n\n\tdef setupShortcuts(self):\n\t\tQShortcut(QKeySequence('Ctrl+Q'), self).activated.connect(self.closeApp)\n\n\tdef setupSystemTray(self):\n\t\tself.TrayIcon = QSystemTrayIcon(QIcon(PATH_TO_ICON))\n\t\tself.TrayIcon.setToolTip(\"ClipPy\")\n\t\tself.TrayMenu = QMenu(self)\n\t\texitAction = self.TrayMenu.addAction(\"Exit\")\n\t\texitAction.triggered.connect(self.closeApp)\n\t\tshowAction = self.TrayMenu.addAction(\"Show\")\n\t\tshowAction.triggered.connect(self.show)\n\t\tshowAction.triggered.connect(self.ui.searchBar.setFocus)\n\t\tsettingsAction = self.TrayMenu.addAction(\"Settings\")\n\t\tself.TrayIcon.setContextMenu(self.TrayMenu)\n\t\tself.TrayIcon.show()\n\n\tdef connectSignalsAndSlots(self):\n\t\tself.ClipListener.newClipSignalEvent.connect(lambda clip: self.newClipEventSlot(clip))\n\t\tself.ClipListener.unavailableClipEvent.connect(lambda status: print(f\"ClipListener: {status}\"))\n\t\tself.HotKeyListener.combinationDetected.connect(lambda cmd: self.hotkeySlot(cmd))\n\n\t\tself.ui.clipsListWidget.itemActivated.connect(self.itemClipActivatedCallback)\n\t\tself.ui.searchBar.textChanged.connect(lambda text: self.filterClipboard(text))\n\t\tself.ui.searchBar.returnPressed.connect(lambda: self.ui.clipsListWidget.setFocus())\n\t\tself.ui.searchBar.returnPressed.connect(lambda: self.ui.clipsListWidget.setCurrentRow(0))\n\n\t\tself.ui.settingsBtn.clicked.connect(lambda: self.HotKeyListener.doWork())\n\t\tself.ui.closeAppBtn.clicked.connect(self.closeApp)\n\n# Slots:\n\t@Slot()\n\tdef newClipEventSlot(self, clip: str):\n\t\tnow = datetime.now()\n\t\tclipData = {\n\t\t\t\"id\": str(uuid4()),\n\t\t\t\"type\": \"text\",\n\t\t\t\"content\": clip,\n\t\t\t\"date\": now.strftime(\"%d/%m/%Y, %H:%M:%S\"),\n\t\t}\n\t\tpprint(clipData)\n\t\tself.ItemManager.newItem(clipData)\n\n\t@Slot()\n\tdef hotkeySlot(self, cmd: str):\n\t\tdef c():\n\t\t\tif not self.isVisible():self.center()\n\t\t\tself.setVisible(not self.isVisible())\n\n\t\tif cmd == \"h\": self.ui.clipsListWidget.clear()\n\t\tif cmd == \"z\": self.itemClipActivatedCallback(self.ui.clipsListWidget.item(1)) if self.ui.clipsListWidget.count() > 1 else None\n\t\tif cmd == \"c\": c()\n\n# Callbacks:\n\tdef itemClipActivatedCallback(self, item: QListWidgetItem):\n\t\tdef  sling_method():\n\t\t\tself.ui.statusLabel.setText(\"ClipPy v.0.1\")\n\t\t\tself.ui.statusLabel.setStyleSheet(\"color: grey;\")\n\n\t\ttxt = self.ui.clipsListWidget.itemWidget(item).getClipContent()\n\t\tcliplib.copy(txt)\n\t\tself.pushClipToDataBase(item.text())\n\t\tself.notify(\"ClipPy - Notifier\", f\"{item.text()} copied to the clipboard!\", 1000)\n\n\t\tself.ui.statusLabel.setStyleSheet(\"color: #5E81AC;\")\n\t\tself.ui.statusLabel.setText(f\"Entry copied to the clipboard!\")\n\t\tQTimer.singleShot(3500, sling_method)\n\t\tQTimer.singleShot(400, self.hide)\n\n\tdef itemClipSelectedCallback(self, item: QListWidgetItem):\n\t\tself.ui.clipsListWidget.setItemSelected(item, True)\n\n# Methods:\n\tdef removeClipWidgetItem(self, item: QListWidgetItem):\n\t\tindex = self.ui.clipsListWidget.indexFromItem(item).row()\n\t\titem = self.ui.clipsListWidget.takeItem(index)\n\n\tdef pushClipToDataBase(self, clip: str):\n\t\tpass\n\n\tdef filterClipboard(self, text: str):\n\t\tfor index in range(self.ui.clipsListWidget.count()):\n\t\t\titem = self.ui.clipsListWidget.item(index)\n\t\t\twidget = self.ui.clipsListWidget.itemWidget(item)\n\t\t\tcontent = widget.getClipContent()\n\t\t\titem.setHidden(not text.lower() in content.lower())\n\n\tdef notify(self, title: str, msg: str, timeout: int):\n\t\tif host == \"*unix\":\n\t\t\tnotification = notify2.Notification(summary = title, message = msg)\n\t\t\tnotification.set_timeout(timeout)\n\t\t\tnotification.show()\n\t\telse: winNotify.show_toast(title, msg, duration = int(timeout/1000), threaded = True)\n\n# Internal Events:\n\tdef hideEvent(self, event: QEvent):\n\t\tself.TrayIcon.show()\n\t\tprint(\"Hidden\")\n\n\tdef showEvent(self, event: QEvent):\n\t\tself.TrayIcon.hide()\n\t\tprint(\"Shown\")\n\n# Private:\n\tdef setRoundEdges(self):\n\t\tself.radius = 8.0\n\t\tself.path = QPainterPath()\n\t\tself.path.addRoundedRect(QRectF(self.rect()), self.radius, self.radius)\n\t\tself.mask = QRegion(self.path.toFillPolygon().toPolygon())\n\t\tself.setMask(self.mask)\n\t\n\tdef center(self):\n\t\tself.x_shift = 0 #-10\n\t\tself.y_shift = 0 #-360\n\t\tself.frame = self.frameGeometry()\n\t\tscreen = QGuiApplication.screenAt(QApplication.desktop().cursor().pos())\n\t\tcenterPoint = screen.availableGeometry().center()\n\t\tself.frame.moveCenter(centerPoint)\n\t\tself.move(self.frame.topLeft().x()+self.x_shift, self.frame.topLeft().y()+self.y_shift)\n\n\tdef stopRunningThreads(self):\n\t\tself.ClipListener.stop()\n\t\tself.ClipListener.quit()\n\t\tself.ClipListener.wait()\n\t\tself.HotKeyListener.stop()\n\t\tself.HotKeyListener.quit()\n\t\tself.HotKeyListener.wait()\n\t\tprint(\"ClipListener Thread: \", self.ClipListener.isRunning())\n\t\tprint(\"HotKeyListener Thread: \", self.HotKeyListener.isRunning())\n\n\tdef closeApp(self):\n\t\tself.setWindowFlags(self.windowFlags() & ~Qt.Popup) # Removing the popup flag because it prevents the app from fulling closing\n\t\tself.stopRunningThreads()\n\t\tself.close()\n\t\tsys.exit(0)\t\t\t\t\t\t\t\t\t\t\t# To fully close the application flagged as a popup\n\n# Entry Point:\ndef fontCheck(app):\n    font = QFont(\"Segoe UI\")\n    font.setPointSize(11)\n    if host == \"win32\": app.setFont(font)\n    elif host in \"linux darwin\": pass\n    return app\n\nif __name__ == \"__main__\":\n    app = QApplication(sys.argv)\n    app = fontCheck(app)\n    window = App()\n    window.show()\n    sys.exit(app.exec_())\n", "date": "18/01/2023, 20:52:24"}, "4": {"id": "aa106f65-1c37-4496-bced-95a725328249", "type": "text", "content": "\t\tpprint(clipData)\n", "date": "18/01/2023, 20:52:43"}}}